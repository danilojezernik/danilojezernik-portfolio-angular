<div class="fixed inset-0 bg-opacity-50 z-30" *ngIf="isChatOpen" (click)="closeChat()"></div>

<div class="fixed bottom-0 right-0 mb-9">
  <button (click)="toggleChat()"
          class="bg-transparent text-white py-2 px-4 flex items-center">
    <svg height="40" width="40" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
         viewBox="0 0 503.467 503.467" xml:space="preserve" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g>
      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
      <g id="SVGRepo_iconCarrier"> <g transform="translate(1 1)"> <path style="fill:#FF7474;"
                                                                        d="M430.36,37.4v68.267H106.093c-18.773,0-34.133,15.36-34.133,34.133v187.733H37.827 c-18.773,0-34.133-15.36-34.133-34.133v-256c0-18.773,15.36-34.133,34.133-34.133h358.4C415,3.267,430.36,18.627,430.36,37.4"></path>
        <path style="fill:#ECF4F7;"
              d="M362.093,429.933h-256c-18.773,0-34.133-15.36-34.133-34.133v-68.267V139.8 c0-18.773,15.36-34.133,34.133-34.133H430.36h34.133c18.773,0,34.133,15.36,34.133,34.133v256c0,18.773-15.36,34.133-34.133,34.133 H430.36V498.2L362.093,429.933z"></path> </g>
        <path style="fill:#51565F;"
              d="M431.36,503.467c-0.853,0-2.56-0.853-3.413-0.853l-85.333-85.333c-1.707-1.707-1.707-4.267,0-5.973 c1.707-1.707,4.267-1.707,5.973,0l77.653,77.653v-58.027c0-2.56,1.707-4.267,4.267-4.267h34.133 c16.213,0,29.867-13.653,29.867-29.867v-256c0-16.213-13.653-29.867-29.867-29.867h-358.4c-16.213,0-29.867,13.653-29.867,29.867 v256c0,16.213,13.653,29.867,29.867,29.867h213.333c2.56,0,4.267,1.707,4.267,4.267c0,2.56-1.707,4.267-4.267,4.267H106.24 c-21.333,0-38.4-17.067-38.4-38.4v-256c0-21.333,17.067-38.4,38.4-38.4h358.4c21.333,0,38.4,17.067,38.4,38.4v256 c0,21.333-17.067,38.4-38.4,38.4h-29.867v64c0,1.707-0.853,3.413-2.56,4.267C432.213,503.467,432.213,503.467,431.36,503.467z M414.293,349.867H328.96c-2.56,0-4.267-1.707-4.267-4.267c0-2.56,1.707-4.267,4.267-4.267h85.333c2.56,0,4.267,1.707,4.267,4.267 C418.56,348.16,416.853,349.867,414.293,349.867z M294.827,349.867H158.293c-2.56,0-4.267-1.707-4.267-4.267 c0-2.56,1.707-4.267,4.267-4.267h136.533c2.56,0,4.267,1.707,4.267,4.267C299.093,348.16,297.387,349.867,294.827,349.867z M38.827,332.8c-21.333,0-38.4-17.067-38.4-38.4v-256c0-21.333,17.067-38.4,38.4-38.4h358.4c21.333,0,38.4,17.067,38.4,38.4v34.133 c0,2.56-1.707,4.267-4.267,4.267s-4.267-1.707-4.267-4.267V38.4c0-16.213-13.653-29.867-29.867-29.867h-358.4 C22.613,8.533,8.96,22.187,8.96,38.4v256c0,16.213,13.653,29.867,29.867,29.867c2.56,0,4.267,1.707,4.267,4.267 C43.093,331.093,41.386,332.8,38.827,332.8z M397.227,298.667h-85.333c-2.56,0-4.267-1.707-4.267-4.267 c0-2.56,1.707-4.267,4.267-4.267h85.333c2.56,0,4.267,1.707,4.267,4.267C401.493,296.96,399.787,298.667,397.227,298.667z M277.76,298.667H158.293c-2.56,0-4.267-1.707-4.267-4.267c0-2.56,1.707-4.267,4.267-4.267H277.76c2.56,0,4.267,1.707,4.267,4.267 C282.027,296.96,280.32,298.667,277.76,298.667z M414.293,247.467H380.16c-2.56,0-4.267-1.707-4.267-4.267s1.707-4.267,4.267-4.267 h34.133c2.56,0,4.267,1.707,4.267,4.267S416.853,247.467,414.293,247.467z M346.027,247.467H277.76c-2.56,0-4.267-1.707-4.267-4.267 s1.707-4.267,4.267-4.267h68.267c2.56,0,4.267,1.707,4.267,4.267S348.587,247.467,346.027,247.467z M243.627,247.467h-85.333 c-2.56,0-4.267-1.707-4.267-4.267s1.707-4.267,4.267-4.267h85.333c2.56,0,4.267,1.707,4.267,4.267S246.187,247.467,243.627,247.467z M397.227,196.267h-153.6c-2.56,0-4.267-1.707-4.267-4.267c0-2.56,1.707-4.267,4.267-4.267h153.6c2.56,0,4.267,1.707,4.267,4.267 C401.493,194.56,399.787,196.267,397.227,196.267z M209.493,196.267h-51.2c-2.56,0-4.267-1.707-4.267-4.267 c0-2.56,1.707-4.267,4.267-4.267h51.2c2.56,0,4.267,1.707,4.267,4.267C213.76,194.56,212.053,196.267,209.493,196.267z"></path> </g></svg>
  </button>
</div>

<div *ngIf="isChatOpen" id="chat-container" class="fixed bottom-16 shadow-lg z-40 right-4 mb-4 w-80">
  <div class="bg-white shadow-md max-w-lg w-full">

    <div class="p-4 bg-faq flex justify-between items-center">
      <p class="text-lg font-semibold">
        {{ 'pages.chat.title' |translate }}
      </p>
      <button (click)="closeChat()" class="text-red-600 hover:bg-red-600 hover:text-white rounded focus:outline-none focus:text-gray-400">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <!-- Message shows when waiting for an answer -->
    <div *ngIf="loading" class="p-4 h-80 bg-faq text-black flex items-center justify-center">
      <span class="pulse-bulb text-center">
        {{ 'pages.chat.loading' | translate }}
      </span>
    </div>


    <!-- Shows a answer when it is available -->
    <div *ngIf="!loading && response" class="p-4 h-80 bg-faq overflow-y-auto">
      {{ response }}
    </div>

    <div class="p-4 flex bg-faq">
      <input [(ngModel)]="userInput" id="user-input" type="text" [placeholder]="'placeholder.ask' | translate"
             class="bg-white border border-gray-300 text-black text-sm rounded-l-md focus:ring-red-200 focus:border-white block w-full p-2.5">
      <button (click)="sendQuestion()" class="btn-public add px-4 py-2 text-black rounded-r-md transition duration-300">
        {{ 'button.ask' | translate }}
      </button>
    </div>
  </div>
</div>

